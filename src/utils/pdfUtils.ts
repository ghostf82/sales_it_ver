import { jsPDF } from 'jspdf';
import 'jspdf-autotable';

// Amiri font is a good Arabic font that's freely available
const AMIRI_NORMAL_BASE64 = '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QQBtAGkAcgBpAFYAZQByAHMAaQBvAG4AIAAxAC4AMAAwADAAIABKAHUAbgBlACAAMQAzACwAIAAyADAAMQAxACwAIABpAG4AaQB0AGkAYQBsACAAcgBlAGwAZQBhAHMAZQBBAG0AaQByAGkASwBoAG8AbABlAGQAIABIAG8AcwBuAHkAIAAmACAASABhAHMAcwBhAG4AIABWAGUAcgBqAGUAZQBoAHQAdABwADoALwAvAHcAdwB3AC4AYQBtAGkAcgBpAGYAbwBuAHQALgBvAHIAZwBDAG8AcAB5AHIAaQBnAGgAdAAgACgAYwApACAAMgAwADEAMAAsACAAMgAwADEAMgAgAEsAaABvAGwAZQBkACAASABvAHMAbgB5ACAAKABrAGgAbwBsAGUAZABoAG8AcwBuAHkAQABnAG0AYQBpAGwALgBjAG8AbQApACwAIAB3AGkAdABoACAAUgBlAHMAZQByAHYAZQBkACAARgBvAG4AdAAgAE4AYQBtAGUAIABBAG0AaQByAGkALgAgAEMAbwBwAHkAcgBpAGcAaAB0ACAAKABjACkAIAAyADAAMQAwACwAIAAyADAAMQAyACAASABhAHMAcwBhAG4AIABWAGUAcgBqAGUAZQAgACgAbgBvAHUAcgBhAG4AaQAuAGsAaABhAGwAQABnAG0AYQBpAGwALgBjAG8AbQApACwAIAB3AGkAdABoACAAUgBlAHMAZQByAHYAZQBkACAARgBvAG4AdAAgAE4AYQBtAGUAIABBAG0AaQByAGkALgAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQACAQIBAwADAHgB/4WwBI0=';

/**
 * Adds the Amiri font to a jsPDF document for Arabic text support
 * @param doc - The jsPDF document instance
 */
export async function addFontToJsPDF(doc: jsPDF): Promise<void> {
  try {
    // Add the Amiri font for Arabic text support
    doc.addFileToVFS('Amiri-normal.ttf', AMIRI_NORMAL_BASE64);
    doc.addFont('Amiri-normal.ttf', 'Amiri', 'normal');
    
    // Set the font
    doc.setFont('Amiri');
    
    return Promise.resolve();
  } catch (error) {
    console.error('Error adding font to PDF:', error);
    return Promise.reject(error);
  }
}